llm:
  providers:
    openrouter:
      api_key_env: OPENROUTER_API_KEY
      base_url: https://openrouter.ai/api/v1/chat/completions
      headers:
        HTTP-Referer: https://github.com/paperKG
        X-Title: PaperKG
    deepseek:
      api_key_env: DEEPSEEK_API_KEY
      base_url: https://api.deepseek.com/chat/completions
      headers: {}
  default_provider: deepseek
  agents:
    research_narrative:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 6000
      temperature: 0.3
      structured_output:
        enable: false
        strict: false
        schema_name: research_narrative
    research_narrative_selector:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 3000
      temperature: 0.2
    research_narrative_fallback:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 6000
      temperature: 0.3
    metadata:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 2000
      temperature: 0.2
    json_repair:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 4000
      temperature: 0.1
    multimedia_content:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 8000
      temperature: 0.1
    keywords_extractor:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 1000
      temperature: 0.1
    quality_rater:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 2000
      temperature: 0.0
    content_refiner:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 6000
      temperature: 0.2
    citation_purpose:
      provider: deepseek
      model: deepseek-chat
      max_tokens: 300
      temperature: 0.2

workflow:
  enable_async: true
  api_timeout: 300
  retry_attempts: 3
  retry_delay: 2
  batch_parallel_limit: 3
  api_concurrent_limit: 10
  iterative_refine:
    enable: true
    max_rounds: 3
    stop_on_no_change: true

context:
  max_context_length: 500000
  evidence_max_chars: 20000
  evidence_max_segments: 200
  citation_context_chars: 2000

narrative:
  min_counts:
    background: 3
    research_gaps: 1
    research_questions: 1
    research_objectives: 1
    hypotheses: 0
  evidence_pool:
    per_section_min: 10
    per_section_max: 80
  chain_relevance:
    min_score: 1.5
    use_citations: true
    use_distance: true
    max_distance: 8
    fallback_top_k: 0
  coverage_fill:
    enable: true
    per_section_add: 12
    max_total_add: 80
    min_segment_chars: 40

logging:
  output_dir: logs
  level: INFO
  console_format: "%(levelname)s: %(message)s"
  file_format: "%(asctime)s - %(levelname)s - %(name)s - %(message)s"
  enable_progress_bar: true
  min_log_level_console: INFO
  min_log_level_file: DEBUG

file_processing:
  text_encoding: utf-8

output:
  indent: 2
  ensure_ascii: false

source_files:
  default_source_dir: source_files
  supported_extensions:
    - .md
    - .markdown
    - .txt

repair:
  enable_schema_repair: true
  max_repair_chars: 40000

quality:
  enable: true
  use_llm: true
  rule_weight: 0.4
  llm_weight: 0.6
  threshold: 75
  refine_rounds: 1

crossref:
  enable: true
  user_agent: paperKG/1.0
  timeout: 10
  max_retries: 5
  retry_delay: 1
  concurrent_requests_limit: 3
  enable_cache: true
  cache_ttl: 3600
  fallback_to_llm: true
  query_strategy: auto
  empty_string_for_missing: true
  simple_llm_fallback: true

neo4j:
  enable: true
  mapping_path: config/neo4j_mapping.json
  clear_before_import: true

keywords:
  enable: true
  max_keywords: 12
  language: en
  use_llm: true

metadata:
  use_crossref_first: true
  llm_window_ratio: 0.15
  llm_max_chars: 60000
  retry_if_missing: true
  required_fields:
    - title
    - authors
    - publication_year
    - journal_or_conference
    - abstract
    - keywords

multimedia:
  retry_if_empty: true
  require_images_if_figure_mentions: true
  require_formulas_if_equation_mentions: true

citation_purpose:
  enable: true
  max_refs: 50
  context_window: 1

